<div class="alerta-container">
  <!-- Filtros -->
  <div class="filtros">
    <input type="text" [(ngModel)]="filtroNome" placeholder="üîç Filtrar por nome" />
    <select [(ngModel)]="filtroCategoria">
      <option value="">Todas as categorias</option>
      <option *ngFor="let cat of categorias" [value]="cat">{{ cat }}</option>
    </select>
  </div>

  <!-- Mensagens de alerta -->
  <p *ngIf="produtosFiltrados.length > 0" class="alerta-estoque">
    ‚ö†Ô∏è Aten√ß√£o! Existem {{ produtosFiltrados.length }} produto(s) com estoque baixo ou validade pr√≥xima.
  </p>

  <p *ngIf="produtosFiltrados.length === 0" class="mensagem-ok">
    ‚úÖ Todos os produtos est√£o com estoque acima de {{ limiteMinimo }} unidades e validade em dia.
  </p>

  <!-- Tabela de produtos -->
  <table *ngIf="produtosFiltrados.length > 0" class="tabela-estoque">
    <thead>
      <tr>
        <th>Produto</th>
        <th>C√≥digo de Barras</th>
        <th>Estoque Atual</th>
        <th>Estoque M√≠nimo</th>
        <th>Categoria</th>
        <th>Validade</th>
        <th>Aviso</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let p of produtosFiltrados">
        <td>{{ p.nome }}</td>
        <td>{{ p.codigo_barras }}</td>
        <td [ngClass]="{ 'estoque-baixo': p.estoqueAtual <= limiteMinimo }">
          {{ p.estoqueAtual }}
        </td>
        <td>{{ limiteMinimo }}</td>
        <td>{{ p.categoria?.nome }}</td>
        <td>{{ p.data_validade ? (p.data_validade | date:'dd/MM/yyyy') : '-' }}</td>
        <td>
          <span *ngIf="getAlertaTipo(p)" [ngClass]="{
            'alerta-vermelho': p.estoqueAtual <= limiteMinimo,
            'alerta-laranja': p.data_validade && p.estoqueAtual > limiteMinimo
          }">
            {{ getAlertaTipo(p) }}
          </span>
        </td>
      </tr>
    </tbody>
  </table>
</div>
