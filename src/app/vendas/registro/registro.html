<h2 class="titulo">ğŸ§¾ Registro de Vendas</h2>
<hr class="divisor" />

<!-- Scanner e seleÃ§Ã£o de cÃ¢mera -->
<div class="scanner-container">
  <mat-form-field appearance="outline" class="campo">
    <mat-label>Selecionar CÃ¢mera</mat-label>
    <mat-select [(value)]="selectedDevice" aria-label="Selecionar cÃ¢mera">
      <mat-option *ngFor="let device of availableDevices" [value]="device">
        {{ device.label || 'CÃ¢mera ' + device.deviceId }}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <zxing-scanner
    [formats]="formats"
    [device]="selectedDevice"
    [autostart]="true"
    (scanSuccess)="onCodeResult($event)">
  </zxing-scanner>
</div>

<!-- Mensagens de erro -->
<p *ngIf="erro" class="erro-msg">{{ erro }}</p>

<!-- Forma de pagamento -->
<mat-form-field appearance="outline" class="campo">
  <mat-label>Forma de Pagamento</mat-label>
  <mat-select [(value)]="formaPagamento">
    <mat-option value="Ã€ vista">Ã€ vista</mat-option>
    <mat-option value="Parcelado">Parcelado</mat-option>
  </mat-select>
</mat-form-field>

<!-- Tabela de itens -->
<table class="registro-tabela" *ngIf="itens.length > 0">
  <thead>
    <tr>
      <th>Produto</th>
      <th>PreÃ§o UnitÃ¡rio (FCFA)</th>
      <th>Quantidade</th>
      <th>Subtotal</th>
      <th>AÃ§Ãµes</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let item of itens">
      <td>{{ item.produto?.nome }}</td>
      <td>{{ item.preco_unitario | currency:'XOF':'symbol':'1.0-0' }}</td>
      <td>{{ item.quantidade }}</td>
      <td>{{ (item.preco_unitario * item.quantidade) | currency:'XOF':'symbol':'1.0-0' }}</td>
      <td>
        <button mat-icon-button color="warn" (click)="removerItem(item)" aria-label="Remover item">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </tr>
  </tbody>
</table>

<h3 class="registro-total" *ngIf="total > 0">ğŸ’° Total: {{ total | currency:'XOF':'symbol':'1.0-0' }}</h3>

<!-- FormulÃ¡rio manual -->
<div class="form-item-container">
  <app-form-item-venda (itemAdicionado)="inserirItem($event)"></app-form-item-venda>
</div>

<!-- BotÃµes -->
<div class="botoes">
  <button mat-raised-button color="primary" (click)="registrarVenda()" *ngIf="itens.length > 0">
    ğŸ’¾ Registrar Venda
  </button>
  <button mat-button color="warn" (click)="limparRegistro()" *ngIf="itens.length > 0">
    ğŸ§¹ Limpar
  </button>
  <button mat-stroked-button color="accent" (click)="fechar()">
    âŒ Sair da Tela Cheia
  </button>
</div>