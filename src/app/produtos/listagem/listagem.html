<h2 class="titulo">📊 Histórico de Vendas</h2>

<form (ngSubmit)="buscarVendas()" class="filtro-form">
  <div class="form-group">
    <label for="data_inicio">Data Início:</label>
    <input type="date" [(ngModel)]="filtros.data_inicio" name="data_inicio" id="data_inicio" />
  </div>

  <div class="form-group">
    <label for="data_fim">Data Fim:</label>
    <input type="date" [(ngModel)]="filtros.data_fim" name="data_fim" id="data_fim" />
  </div>

  <div class="form-group">
    <label for="produto_id">Produto:</label>
    <select [(ngModel)]="filtros.produto_id" name="produto_id" id="produto_id">
      <option value="">Todos</option>
      <option *ngFor="let p of produtos" [value]="p.id">{{ p.nome }}</option>
    </select>
  </div>

  <button type="submit" class="btn-filtrar">🔍 Filtrar</button>
</form>

<div *ngFor="let venda of vendas" class="venda-card">
  <h3>🧾 Venda #{{ venda.id }} - {{ venda.data_venda | date:'short' }}</h3>
  <p><strong>Total:</strong> {{ venda.total | currency:'XOF':'symbol':'1.0-0' }}</p>

  <table class="tabela-venda">
    <thead>
      <tr>
        <th>Produto</th>
        <th>Qtd</th>
        <th>Preço Unitário</th>
        <th>Subtotal</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of venda.itens">
        <td>{{ item.produto?.nome }}</td>
        <td>{{ item.quantidade }}</td>
        <td>{{ item.preco_unitario }}</td>
        <td>{{ item.subtotal }}</td>
      </tr>
    </tbody>
  </table>
</div>